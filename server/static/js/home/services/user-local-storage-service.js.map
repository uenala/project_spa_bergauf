{"version":3,"sources":["home/services/user-local-storage-service.ts"],"names":["Home","Home.Services","Home.Services.UserLocalStorage","Home.Services.UserLocalStorage.constructor","Home.Services.UserLocalStorage.get","Home.Services.UserLocalStorage.GetAll","Home.Services.UserLocalStorage.GetById","Home.Services.UserLocalStorage.GetByUsername","Home.Services.UserLocalStorage.Create","Home.Services.UserLocalStorage.Update","Home.Services.UserLocalStorage.Delete","Home.Services.UserLocalStorage.getUsers","Home.Services.UserLocalStorage.setUsers"],"mappings":"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","file":"home/services/user-local-storage-service.js","sourceRoot":"/Users/erol/CAS_FEE/git/casfee/project_spa_bergauf/SpaBergaufDotCh/","sourcesContent":["///<reference path='../../../typings/tsd.d.ts' />\nmodule Home.Services {\n  'use strict';\n\n  export interface IUserLocalStorage {\n    get():string;\n    GetAll(): any;\n    GetById(id): any;\n    GetByUsername(username): any;\n    Create(user): any;\n    Update(user): any;\n    Delete(id): any;\n  }\n\n\n  class UserLocalStorage {\n    public static $inject = ['$filter', '$q', '$localStorage', '$log'\n    ];\n\n    constructor(private $filter: ng.IFilterService, private $q : ng.IQService, private $localStorage: any, private $log: ng.ILogService) {\n      var vm = this;\n    }\n\n    get():string {\n      return 'UserLocalStorage';\n    }\n\n    GetAll() {\n    var deferred = this.$q.defer();\n    deferred.resolve(this.getUsers());\n    return deferred.promise;\n  }\n\n    GetById(id) {\n    var deferred = this.$q.defer();\n    var filtered = this.$filter('filter')(this.getUsers(), { id: id });\n    var user = filtered.length ? filtered[0] : null;\n    deferred.resolve(user);\n    return deferred.promise;\n  }\n\n    GetByUsername(username) {\n    var deferred = this.$q.defer();\n    var filtered = this.$filter('filter')(this.getUsers(), { username: username });\n    var user = filtered.length ? filtered[0] : null;\n    deferred.resolve(user);\n    return deferred.promise;\n  }\n\n    Create(user) {\n    var deferred = this.$q.defer();\n\n      this.GetByUsername(user.username)\n        .then(function (duplicateUser) {\n          if (duplicateUser !== null) {\n            deferred.resolve({ success: false, message: 'Diese Email \"' + user.username + '\" ist bereits registriert' });\n          } else {\n            var users =  JSON.parse(localStorage.getItem(\"users\"));\n\n            // assign id\n            var lastUser = users[users.length - 1] || { id: 0 };\n            user.id = lastUser.id + 1;\n\n            // save to local storage\n            users.push(user);\n            localStorage.setItem(\"users\", JSON.stringify(users));\n\n            deferred.resolve({ success: true });\n          }\n        });\n\n\n    return deferred.promise;\n  }\n\n    Update(user) {\n    var deferred = this.$q.defer();\n\n    var users = this.getUsers();\n    for (var i = 0; i < users.length; i++) {\n      if (users[i].id === user.id) {\n        users[i] = user;\n        break;\n      }\n    }\n    this.setUsers(users);\n    deferred.resolve();\n\n    return deferred.promise;\n  }\n\n\n    Delete(id) {\n    var deferred = this.$q.defer();\n\n    var users = this.getUsers();\n    for (var i = 0; i < users.length; i++) {\n      var user = users[i];\n      if (user.id === id) {\n        users.splice(i, 1);\n        break;\n      }\n    }\n    this.setUsers(users);\n    deferred.resolve();\n\n    return deferred.promise;\n  }\n\n    // private functions\n\n    getUsers(): any {\n      var users: string = localStorage.getItem(\"users\");\n      if (users === null || typeof users === \"undefined\" || users === \"undefined\"){\n        this.$log.debug(\"LocalStorageService::read('users') not found, returned null\");\n        localStorage.setItem(\"users\", \"[]\");\n        return null;\n      }\n      else {\n        this.$log.debug(\"LocalStorageService::read('users')\");\n        return JSON.parse(localStorage.getItem(\"users\"));\n      }\n    }\n\n    setUsers(users) {\n      localStorage.setItem(\"users\", JSON.stringify(users));\n    }\n  }\n\n  /**\n   * @ngdoc service\n   * @name home.service:UserLocalStorage\n   *\n   * @description\n   *\n   */\n  angular\n    .module('home')\n    .service('UserLocalStorage', UserLocalStorage);\n}\n"]}